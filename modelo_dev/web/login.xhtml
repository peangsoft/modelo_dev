<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <ui:include src="head_login.xhtml" />
    <f:event listener="#{login.terminar_utilizador()}" type="preRenderView"/>

    <h:body style="align-content: center">
        <br/> <br/><br/>
        <div class="content container" style="width: 70%">
            <div class="wrap" style="font-family: tahoma" >

                <div class="panel panel-primary">                                   
                    <div class="panel-body" align="center">
                        <div class="table-responsive">
                            <div class="single-widget-container">
                                <section class="widget login-widget">
                                    <header class="text-align-center">
                                        <img src="img/logo_MDS.png" width="91" height="91" alt="logo_MDS"/>
                                        <h4>Entrar com a sua conta mdsinsure.com</h4>
                                    </header>
                                    <div class="body">
                                        <h:form class="no-margin" id="frmlogin">

                                            <iframe name='myIFrame' id="myIFrame" style='display:none'></iframe>
                                            <p:growl id="growl" showDetail="false" sticky="true" life="2500"/>

                                            <div class="form-actions">

                                                <div class="g-signin2" data-onsuccess="onSignIn" data-theme="dark" align="center" data-width="150" data-height="40"></div>

                                                <br/>
                                                <div class="forgot">
                                                    Problemas com autênticação?
                                                    <a class="forgot" href="#">Contacte:suporte@mdsinsure.com</a>
                                                </div>

                                            </div>

                                        </h:form>
                                    </div>
                                </section>
                                <div align="center" class="animated">
                                    <footer>
                                        <p>
                                            <font size="2"> &copy; |direitos reservados <a href="http://www.mdsinsure.com">MDS</a></font>
                                        </p>
                                    </footer>
                                </div>
                            </div>    
                        </div>
                    </div>
                </div>

            </div>
        </div>
        <script>

            function onSignIn(googleUser) {
                var profile = googleUser.getBasicProfile();

                loggedIn = true;

                // The ID token you need to pass to your backend:
                //  var id_token = googleUser.getAuthResponse().id_token;
                // console.log("ID Token: " + id_token);

                window.location = "http://localhost:8084/economato/index.xhtml?user=" + profile.getName() + "," + profile.getImageUrl() + "," + profile.getEmail();
            }

        </script>

        <f:event listener="#{login.validateUsernamePassword()}" type="postValidate"/>

    </h:body>
</html>